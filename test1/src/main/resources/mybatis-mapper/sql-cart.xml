<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.CartMapper">
	<!-- 장바구니 리스트 검색 -->
	<select id="selectCartList" parameterType="hashmap" resultType="com.example.test1.model.Cart">
		SELECT DISTINCT
				C.PRODUCT_NO, C.CART_NO, C.MEMBER_NO,
				C.CART_PRODUCT_AMOUNT, C.PRODUCT_ATT_NO, P.PRODUCT_THUMBNAIL,
				P.PRODUCT_NAME, P.PRODUCT_SELL_PRICE, P.PRODUCT_SALE_PRICE,
                M.MEMBER_GRADE
			FROM 
				CART C, PRODUCT P, MEMBER M 
			WHERE 
				C.MEMBER_NO= #{MEMBER_NO}
		    		AND C.PRODUCT_NO=P.PRODUCT_NO
	</select>
	<!-- 장바구니 제품 수량수정 -->
	<update id="cartModify" parameterType="hashmap">
		UPDATE CART
		SET
			CART_PRODUCT_AMOUNT = ${CART_PRODUCT_AMOUNT}
		WHERE
			CART_NO = ${CART_NO}
	</update>
	
	<!-- 해당 제품 장바구니 삭제 -->
	<delete id="cartDelete" parameterType="hashmap">
		DELETE FROM CART
		WHERE CART_NO = ${CART_NO}
	</delete>
	
	<!-- 해당 회원의 장바구니 제품 전체삭제 -->
	<delete id="cartAllDelete" parameterType="hashmap">
			DELETE FROM CART
			WHERE MEMBER_NO = ${MEMBER_NO}
	</delete>
	
	<!-- 찜에 존재하는지 확인 -->
	<select id="selectProductLike" parameterType="hashmap" resultType="hashmap">
			SELECT COUNT(LIKE_NO) LIKE_CNT
			FROM 
				PRODUCT_LIKE 
			WHERE 
				MEMBER_NO= #{MEMBER_NO}
		    AND PRODUCT_NO=${PRODUCT_NO}
	</select>
	
	<!-- 찜테이블에 제품 추가 -->
	<insert id="insertProductsLike" parameterType="hashmap">
		<![CDATA[
			INSERT INTO PRODUCT_LIKE
			(
				LIKE_NO,
			    PRODUCT_NO, 
			    MEMBER_NO, 
			    LIKE_DATE
			)
			VALUES
			(
				${PRODUCT_NO},
				#{MEMBER_NO},
				SYSDATE
			)
		]]>
	</insert>
	
</mapper>